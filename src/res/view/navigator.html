<p>@error@</p>
@%'insert/playctrl.html'@
@%'insert/directories.html'@
<table style="width:900px;margin:auto;background-color:#DDE">
  <tr>
    <th>@label.track@</th>
    <th>@label.song@</th>
    <th>@label.artist@</th>
    <th>@label.album@</th>
    <th>@label.year@</th>
    <th>@label.genre@</th>
    <th>@label.length@</th>
    <th>@label.samplerate@</th>
 </tr>
 @model(
    <tr onmouseover="focusSong(this)" onmouseout="meanSong(this)">
       <td>@element.getAttribute*(Track)*@</td>
       <td>
         <div>@element.getAttribute*(Title)*@</div>
         <div id="play_btn" style="display:none;position:relative;left:0"><a href="javascript:void(0)" onclick="play('@^element.getAttribute*(MediaPath)*@')">
           <img src="../image/play_btn.png" alt="@label.play@"></a>&nbsp;
           <a href="javascript:void(0)" onclick="addToPlay('@^element.getAttribute*(MediaPath)*@')">
           <img src="../image/add_playlist_btn.png" alt="@label.add_play@"></a>
         </div>
       </td>
       <td>@element.getAttribute*(Artist)*@</td>
       <td>@element.getAttribute*(Album)*@</td>
       <td>@element.getAttribute*(Year)*@</td>
       <td>@element.getAttribute*(Genre)*@</td>
       <td>@element.getAttribute*(Length)*@</td>
       <td>@element.getAttribute*(Samplerate)*@</td>
    </tr>
 )@
</table>
<div id="player">
</div>
<script src="@contextpath@/js/ui.js" language="Javascript"></script>
<script>   
	function initFields() {
		try {
			var MediaControls = Windows.Media.MediaControl;

			// Add event listeners for the buttons
			MediaControls.addEventListener('playpressed', resumePlay, false);
			MediaControls.addEventListener('pausepressed', pausePlay, false);
			MediaControls.addEventListener('playpausetogglepressed',
					togglePlay, false);
		} catch (e) {
		}		
		handlerUrl = 'Navigator/ajax/Asyncupdate';
		// run it async
		updateUI();
		updateDirectories();
	}
	function focusSong(tr) {
		tr.style.backgroundColor = '#def';
		var cdiv = getPlayCtrlDiv(tr);
		cdiv.style.display = '';
	}
	function meanSong(tr) {
		tr.style.backgroundColor = '#DDE';
		var cdiv = getPlayCtrlDiv(tr);
		cdiv.style.display = 'none';
	}
	function getPlayCtrlDiv(tr) {
		for ( var i = 0; i < tr.cells.length; i++) {
			//var d = tr.cells[i].firstChild;
			//if (d && d.id == 'play_btn')
			//	return d;
			for (var j=0; j<tr.cells[i].childNodes.length; j++)
				if (tr.cells[i].childNodes[j].id == 'play_btn')
					return tr.cells[i].childNodes[j];
		}
		return null;
	}
</script>